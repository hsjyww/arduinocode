// [아두이노 기초 30편] 8채널 릴레이 + LED → 미니 크리스마스 조명쇼
// USB 케이블 전원 사용 / Active LOW 릴레이 모듈 기준
#include <Arduino.h>
const int relayPins[8] = {2, 3, 4, 5, 6, 7, 8, 9};
const int N = 8;

void setup()
{
    for (int i = 0; i < N; i++)
    {
        pinMode(relayPins[i], OUTPUT);
        digitalWrite(relayPins[i], HIGH); // OFF로 시작
    }
}

void allOn(int hold = 150)
{
    for (int i = 0; i < N; i++)
        digitalWrite(relayPins[i], LOW);
    delay(hold);
}

void allOff(int hold = 150)
{
    for (int i = 0; i < N; i++)
        digitalWrite(relayPins[i], HIGH);
    delay(hold);
}

void patternChase(int rep = 3)
{
    for (int r = 0; r < rep; r++)
    {
        for (int i = 0; i < N; i++)
        {
            allOff(0);
            digitalWrite(relayPins[i], LOW);
            delay(120);
        }
    }
}

void patternWave(int rep = 2)
{
    for (int r = 0; r < rep; r++)
    {
        for (int i = 0; i < N; i++)
        {
            allOff(0);
            digitalWrite(relayPins[i], LOW);
            delay(100);
        }
        for (int i = N - 1; i >= 0; i--)
        {
            allOff(0);
            digitalWrite(relayPins[i], LOW);
            delay(100);
        }
    }
}

void patternOddEven(int rep = 4)
{
    for (int r = 0; r < rep; r++)
    {
        allOff(0);
        for (int i = 0; i < N; i += 2)
            digitalWrite(relayPins[i], LOW);
        delay(200);
        allOff(0);
        for (int i = 1; i < N; i += 2)
            digitalWrite(relayPins[i], LOW);
        delay(200);
    }
}

void patternCenterOut(int rep = 3)
{
    int L = (N / 2) - 1;
    int R = (N / 2);
    for (int r = 0; r < rep; r++)
    {
        allOff(0);
        int l = L, rr = R;
        while (l >= 0 && rr < N)
        {
            digitalWrite(relayPins[l], LOW);
            digitalWrite(relayPins[rr], LOW);
            delay(150);
            l--;
            rr++;
        }
        delay(200);
    }
    allOff(0);
}

void patternSparkle(int rep = 40)
{
    for (int r = 0; r < rep; r++)
    {
        int i = random(0, N);
        digitalWrite(relayPins[i], LOW);
        delay(80);
        digitalWrite(relayPins[i], HIGH);
    }
}

void patternStrobe(int rep = 6)
{
    for (int r = 0; r < rep; r++)
    {
        allOn(100);
        allOff(100);
    }
}

void loop()
{
    patternChase();
    patternWave();
    patternOddEven();
    patternCenterOut();
    patternSparkle();
    patternStrobe();
}
